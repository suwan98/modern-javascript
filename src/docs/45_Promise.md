# ëª¨ë˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ 45ì¥ : Promise

## ê°œìš”

**ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ í•˜ë‚˜ì˜ íŒ¨í„´ìœ¼ë¡œ ì½œë°±í•¨ìˆ˜ë¥¼ ì‚¬ìš©**

- ê·¸ëŸ¬ë‚˜ ì „í†µì ì¸ ì½œë°± íŒ¨í„´ì€ ì½œë°± ì§€ì˜¥ìœ¼ë¡œ ì¸í•´ ê°€ë…ì„±ì´ ë‚˜ì˜ê³  ë¹„ë™ê¸° ì²˜ë¦¬ ì¤‘ ë°œìƒí•œ ì—ëŸ¬ì²˜ë¦¬ê°€ ì–´ë ¤ì›€
- ì—¬ëŸ¬ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ëŠ”ë° ë˜í•œ í•œê³„ê°€ ì¡´ì¬

**ES6 ìƒˆë¡œìš´ íŒ¨í„´ â¡ï¸ í”„ë¡œë¯¸ìŠ¤**

- ì „í†µì ì¸ ì½œë°°íŒ¨í„´ì´ ê°€ì§„ ë‹¨ì ì„ ë³´ì™„
- ë¹„ë™ê¸°ì²˜ë¦¬ ì‹œì ì„ ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆê²Œëœë‹¤

## ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½œë°±íŒ¨í„´ì˜ ë‹¨ì ë“¤

### ì½œë°± ì§€ì˜¥(Callback Hell)

**`getData` í•¨ìˆ˜ëŠ” ë¹„ë™ê¸°í•¨ìˆ˜ì´ë‹¤.**

- ë¹„ë™ê¸° í•¨ìˆ˜ë€?
  - í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì½”ë“œê°€ í¬í•¨ë˜ì–´ ìˆëŠ” í•¨ìˆ˜
  - ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ ì‹œ í•¨ìˆ˜ ë‚´ë¶€ì˜ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì½”ë“œê°€ ì™„ë£Œë˜ì§€ ì•Šì•˜ë‹¤ í•´ë„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì¦‰ì‹œ ì¢…ë£Œ
    - ì¦‰, ë¹„ë™ê¸° í•¨ìˆ˜ ë‚´ë¶€ì˜ ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ëŠ” ì½”ë“œëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ê°€ ì¢…ë£Œëœ ì´í›„ì— ì™„ë£Œëœë‹¤.
    - ë”°ë¼ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ëŠ” ì½”ë“œì—ì„œ ì²˜ë¦¬ê²°ê³¼ë¥¼ ì™¸ë¶€ë¡œ ë°˜í™˜í•˜ê±°ë‚˜ ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ë¡œ í• ë‹¹í•˜ê²Œë˜ë©´ ê¸°ëŒ€í•œë˜ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤ âŒ

```js
/* ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½œë°±íŒ¨í„´ì˜ ë‹¨ì ë“¤ */

/* ì½œë°± í—¬ */
const END_POINT = "https://jsonplaceholder.typicode.com/posts/1";
const getData = (url) => {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url);
  xhr.send();

  xhr.onload = () => {
    xhr.status === 200
      ? console.log(JSON.parse(xhr.response))
      : console.error(`${xhr.status} ${xhr.statusText}`);
  };
};

/* idê°€ 1ì¸ post ì·¨ë“ */
getData(END_POINT);
```

<img src="./../../assets/docs/45_Promise/image1.png">

**setTimeout í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ì´ë‹¤**

- `setTimeout` í•¨ìˆ˜ê°€ ë¹„ë™ê¸° í•¨ìˆ˜ì¸ ì´ìœ ëŠ”?
  - ì½œë°±í•¨ìˆ˜ì˜ í˜¸ì¶œì´ ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸
  - `setTimeout` í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ëŠ” `setTimeout` í•¨ìˆ˜ê°€ ì¢…ë£Œëœ ì´í›„ì— í˜¸ì¶œ
  - ë”°ë¼ì„œ `setTimeout` í•¨ìˆ˜ ë‚´ë¶€ì˜ ì½œë°±í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬ê²°ê³¼ë¥¼ ì™¸ë¶€ë¡œ ë°˜í™˜í•˜ê±°ë‚˜ ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì— í• ë‹¹í•˜ë©´ ê¸°ëŒ€í•œ ëŒ€ë¡œ ë™ì‘ âŒ

**setTimeout í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ì— ìƒìœ„ ìŠ¤ì½”í”„ì— ë³€ìˆ˜ ê°’ í• ë‹¹í•´ë³´ê¸°**

- `setTimeout` í•¨ìˆ˜ëŠ” ìƒì„±ëœ íƒ€ì´ë¨¸ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ê³ ìœ í•œ íƒ€ì´ë¨¸ `id`ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ ì½œë°±í•¨ìˆ˜ ë‚´ì—ì„œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì€ ë¬´ì˜ë¯¸

```js
/* setTimeout í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ì— ìƒìœ„ ìŠ¤ì½”í”„ì— ë³€ìˆ˜ ê°’ í• ë‹¹í•´ë³´ê¸° */
let global = 0;
setTimeout(() => {
  global = 100;
}, 0);
console.log(global); // 0
```

**ì´ëŸ¬í•œ ë§¥ë½ì—ì„œ getData í•¨ìˆ˜ë„ ë™ì¼í•˜ë‹¤**

- `getData` í•¨ìˆ˜ê°€ ë¹„ë™ê¸° í•¨ìˆ˜ì¸ ì´ìœ ëŠ”?
  - `getData` í•¨ìˆ˜ ë‚´ë¶€ `onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸
- `getData`í•¨ìˆ˜ í˜¸ì¶œ ì‹œ `GET` â¡ï¸ `onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ë“±ë¡ â¡ï¸ `undeinfed`ë¥¼ ë°˜í™˜í•˜ê³  ì¦‰ì‹œ ì¢…ë£Œ
  - ë”°ë¼ì„œ `getData` í•¨ìˆ˜ì˜ `onload`ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì„œë²„ì˜ ì‘ë‹µê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ ìƒìœ„ ìŠ¤ì½”í”„ì— ë³€ìˆ˜ë¥¼ í• ë‹¹í•´ë„ ê¸°ëŒ€í•œ ëŒ€ë¡œ ë™ì‘í•˜ì§€ âŒ
- `xhr.onload`ì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹°ì— ë°”ì¸ë”©í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì˜ ë°˜í™˜ë¬¸ì€ `getData`í•¨ìˆ˜ì˜ ë°˜í™˜ë¬¸ì´ ì•„ë‹ˆë‹¤
  - ë”°ë¼ì„œ `onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì˜ ë°˜í™˜ê°’ì€ í˜„ì¬ ìºì¹˜í•  ìˆ˜ ì—†ê²Œëœë‹¤.

```js
const END_POINT = "https://jsonplaceholder.typicode.com/posts/1";
const getData = (url) => {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url);
  xhr.send();

  xhr.onload = () => {
    xhr.status === 200
      ? console.log(JSON.parse(xhr.response))
      : console.error(`${xhr.status} ${xhr.statusText}`);
  };
};
/* idê°€ 1ì¸ post ì·¨ë“ */
const response = getData(END_POINT);
console.log(response); // undefined
```

**ì„œë²„ì˜ ì‘ë‹µì„ ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì— í• ë‹¹í•˜ë©´?**

- ì´ ë˜í•œ ê¸°ëŒ€í•œëŒ€ë¡œ ë™ì‘ âŒ
- `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹°ì— ë°”ì¸ë”© ëœ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” ì–¸ì œë‚˜ ë§¨ ë§ˆì§€ë§‰ì— `console.log`ê°€ ì¢…ë£Œëœ ì‹œì ì— í˜¸ì¶œ
- ë”°ë¼ì„œ todosë¥¼ ì°¾ìœ¼ë ¤ëŠ” ì‹œì ì€ ì•„ì§ ì „ì—­ë³€ìˆ˜ todosì— ì„œë²„ì— ì‘ë‹µëœ ê²°ê³¼ê°€ í• ë‹¹ë˜ê¸° ì´ì „ì´ë‹¤.

```js
/* ì„œë²„ì˜ ì‘ë‹µì„ ìƒìœ„ ìŠ¤ì½”í”„ì— ë³€ìˆ˜ì— í• ë‹¹í•˜ë©´? */

let todos;

const END_POINT = "https://jsonplaceholder.typicode.com/posts/1";
const getData = (url) => {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url);
  xhr.send();

  xhr.onload = () => {
    xhr.status === 200
      ? (todos = JSON.parse(xhr.response))
      : console.error(`${xhr.status} ${xhr.statusText}`);
  };
};

/* idê°€ 1ì¸ post ì·¨ë“ */
getData(END_POINT);
console.log(todos); // undeinfed
```

**xhr.onload ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ ì„­ì˜ ì‘ë‹µì„ ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì— í• ë‹¹ë˜ë©´ ì²˜ë¦¬ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•ŠëŠ” ì´ìœ **

- ë¹„ë™ê¸° í•¨ìˆ˜ `getData`í˜¸ì¶œ ì‹œ í•¨ìˆ˜ ì½”ë“œë¥¼ í‰ê°€í•˜ëŠ” ê³¼ì •ì—ì„œ `getData` í•¨ìˆ˜ì˜ ì‹¤í–‰ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ê³  ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìŠ¤íƒì— í‘¸ì‰¬
  - ì´í›„ í•¨ìˆ˜ ì½”ë“œ ì‹¤í–‰ í‰ê°€ ê³¼ì •ì—ì„œ `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹°ì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ë°”ì¸ë”©
- getData í•¨ìˆ˜ ì¢…ë£Œì‹œ `getData` í•¨ìˆ˜ì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ì½œìŠ¤íƒì—ì„œíŒ
- ê³§ë°”ë¡œ `conosle.log`ê°€ í˜¸ì¶œ
  - ì´ë•Œ `console.log`ì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ì–´ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìŠ¤íƒì— í‘¸ì‹œ
  - ë§Œì•½ `console.log`ê°€ í˜¸ì¶œ ë˜ê¸° ì§ì „ì— `load` ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ì˜€ë”ë¼ë„ `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹°ì— ë°”ì¸ë”©í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” ê²°ì½” `console.log`ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤ âŒ
- **ì„œë²„ë¡œ ë¶€í„° ì‘ë‹µì´ ë„ì‘í•˜ë©´ xhr ê°ì²´ì—ì„œload ì´ë²¤íŠ¸ê°€ ë°œìƒ**
  - ì´ë•Œ `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì¦‰ì‹œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤ âŒ
  - `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `load` ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì¼ë‹¨ íƒœìŠ¤í¬ íì— ì €ì¥ë˜ì–´ ëŒ€ê¸°í•˜ë‹¤ê°€
    - ì½œìŠ¤íƒì´ ë¹„ê²Œ ë˜ë©´ ì´ë²¤íŠ¸ ë£¨í”„ì— ì˜í•´ ì½œìŠ¤íƒìœ¼ë¡œ í‘¸ì‰¬ë˜ì–´ ì‹¤í–‰
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë„ í•¨ìˆ˜ ì´ë¯€ë¡œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì˜ í‰ê°€ â¡ï¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ ìƒì„± â¡ï¸ ì½œìŠ¤íƒ í‘¸ì‰¬ â¡ï¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì‹¤í–‰ì˜ ê³¼ì •ì„ ê±°ì¹œë‹¤
    - ë”°ë¼ì„œ `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰ë˜ëŠ” ì‹œì ì—ëŠ” ì½œìŠ¤íƒì´ ë¹ˆìƒíƒœì—¬ì•¼í•˜ë¯€ë¡œ `console.log`ëŠ” ì´ë¯¸ ì¢…ë£Œëœ ì´í›„ì´ë‹¤
    - ë§Œì•½ `getData` í•¨ìˆ˜ ì´í›„ `console.log`ê°€ 100ë²ˆ í˜¸ì¶œë˜ì—ˆë‹¤ í•˜ë”ë¼ë„ `xhr.onload` ì´ë²¤íŠ¸ í•¸í‹€ëŸ¬ëŠ” ëª¨ë“  `console.log`ê°€ ì¢…ë£Œëœ ì´í›„ ì‹¤í–‰ëœë‹¤
  - ì¦‰, `xhr.onload` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì— ì„œë²„ì˜ ì‘ë‹µê²°ê³¼ë¥¼ í• ë‹¹í•˜ê¸° ì´ì „ì— `console.log`ê°€ ë¨¼ì € í˜¸ì¶œë˜ `undefined`ê°€ ì¶œë ¥ëœë‹¤

**ì´ì²˜ëŸ¼ ë¹„ë™ê¸° í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì™¸ë¶€ì— ë°˜í™˜ í•  ìˆ˜ ì—†ë‹¤ âŒ**

- ë˜í•œ ìƒìœ„ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜ì—ë„ í• ë‹¹í•  ìˆ˜ ì—†ë‹¤ âŒ
  - ë”°ë¼ì„œ ë¹„ë™ê¸° í•¨ìˆ˜ì˜ ì²˜ë¦¬ê²°ê³¼(ì‘ë‹µ)ì— ëŒ€í•œ í›„ì† ì²˜ë¦¬ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìˆ˜í–‰ë˜ì–´ì•¼ í•œë‹¤
  - ì´ë•Œ ì½œë°±í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 
  - í•„ìš”ì— ë”°ë¼ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì„±ê³µí•  ë•Œ í˜¸ì¶œ ëœ ì½œë°±í•¨ìˆ˜ì™€ ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨ì‹œ í˜¸ì¶œë  ì½œë°±í•¨ìˆ˜ë¥¼ ì „ë‹¬í•œë‹¤

```jsx
/* getDataë¥¼ ì½œë°±íŒ¨í„´ì„ ì‚¬ìš©í•´ ë°ì´í„° ì‘ë‹µê²°ê³¼ë¥¼ ë°˜í™˜ë°›ì„ ìˆ˜ ìˆë‹¤ */
const END_POINT = "https://jsonplaceholder.typicode.com/posts/1";
const getData = (url, success, reject) => {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url);
  xhr.send();

  xhr.onload = () => {
    xhr.status === 200
      ? success(JSON.parse(xhr.response))
      : reject(`${xhr.status} ${xhr.statusText}`);
  };
};
/* idê°€ 1ì¸ post ì·¨ë“ */
getData(END_POINT, console.log, console.error);

/**/
{userId: 1, id: 1, title: 'sunt aut facere repellat provident occaecati excepturi optio reprehenderit', body: 'quia et suscipit\nsuscipit recusandae consequuntur â€¦strum rerum est autem sunt rem eveniet architecto'}
```

**ì½œë°±í—¬**

- ì½œë°±í•¨ìˆ˜ë¥¼ í†µí•´ ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ì— ëŒ€í•œ í›„ì†ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ê°€ ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ê°€ì§€ê³  ë˜ ë‹¤ì‹œ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ í•œë‹¤ë©´
- ì½œë°±í•¨ìˆ˜ í˜¸ì¶œì´ ì¤‘ì²©ë˜ì–´ ë³µì¡ë„ê°€ ë†’ì•„ì§€ëŠ” í˜„ìƒ ë°œìƒ

```tsx
const END_POINT = "https://jsonplaceholder.typicode.com";
const getData = (url, success, reject) => {
  const xhr = new XMLHttpRequest();
  xhr.open("GET", url);
  xhr.send();

  xhr.onload = () => {
    xhr.status === 200
      ? success(JSON.parse(xhr.response))
      : reject(`${xhr.status} ${xhr.statusText}`);
  };
};

/* ì½œë°±í—¬ */
getData(`${END_POINT}/posts/1`, ({userId}) => {
  console.log(userId);

  getData(`${END_POINT}/users/${userId}`, (userInfo) => {
    console.log(userInfo);
  });
});
```

**ì½œë°± í—¬ì€ ê°€ë…ì„±ì„ ë‚˜ì˜ê²Œ í•˜ë©° ì‹¤ìˆ˜ë¥¼ ìœ ë°œ ì‹œí‚¤ëŠ” ì›ì¸ì´ëœë‹¤**

```tsx
/* ì½œë°± í—¬ì€ ê°€ë…ì„±ì„ ë‚˜ì˜ê²Œ í•˜ë©° ì‹¤ìˆ˜ë¥¼ ìœ ë°œ ì‹œí‚¤ëŠ” ì›ì¸ì´ëœë‹¤ */
get("/stp1", (a) => {
  get(`/step2/${a}`, (b) => {
    get(`/step/3/${b}`, (c) => {
      get(`/step/4/${c}`, (d) => {
        console.log(d);
      });
    });
  });
});
```

### ì—ëŸ¬ì²˜ë¦¬ì˜ í•œê³„

**ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½œë°± íŒ¨í„´ì˜ ë¬¸ì œì  ë‘ë²ˆì§¸**

- ì—ëŸ¬ì²˜ë¦¬ê°€ ê³¤ë€í•˜ë‹¤
- `try` ì½”ë“œ ë¸”ë¡ ë‚´ë¶€ í˜¸ì¶œëœ `setTimeout` í•¨ìˆ˜ëŠ” 1ì´ˆ ë’¤ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ íƒ€ì´ë¨¸ë¥¼ ì„¤ì •í•œë‹¤.
  - ì´í›„ ë¹„ë™ê¸° í•¨ìˆ˜ `setTimeout` í•¨ìˆ˜ í˜¸ì¶œ ì‹œ `setTimeout` í•¨ìˆ˜ì˜ ì‹¤í–‰ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ë˜ ì½œìŠ¤íƒì— í‘¸ì‰¬ëœë‹¤
  - ì´í›„ íƒ€ì´ë¨¸ ë§Œë£Œ ì‹œ `setTimeout` í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ëŠ” íƒœìŠ¤í¬ íì— í‘¸ì‰¬ëœë‹¤
  - ì½œìŠ¤íƒì´ ë¹„ì›Œì¡Œì„ ë•Œ ì´ë²¤íŠ¸ ë£¨í”„ì— ì˜í•´ ì½œìŠ¤íƒìœ¼ë¡œ í‘¸ì‰¬ë˜ì–´ ì‹¤í–‰
- `setTimeout` í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ ì‹¤í–‰ ì‹œ `setTimeout` í•¨ìˆ˜ëŠ” ì´ë¯¸ ì½œìŠ¤íƒì—ì„œ ì œê±°ëœ ìƒíƒœ
  - ì´ê²ƒì€ `setTimeout` í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œê²ƒì´ `setTimeout` í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼ëŠ”ê²ƒì´ë¼ëŠ” ì˜ë¯¸ì´ë‹¤
  - `setTimeout` í•¨ìˆ˜ì˜ ì½œë°± í•¨ìˆ˜ì˜ í˜¸ì¶œìê°€ `setTimeout`í•¨ìˆ˜ë¼ë©´ ì½œìŠ¤íƒì˜ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ì½œë°±í•¨ìˆ˜ì˜ ì‹¤í–‰ì»¨í…ìŠ¤íŠ¸ ì¼ë•Œ, í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì˜ í•˜ìœ„ ì‹¤í–‰ì»¨í…ìŠ¤íŠ¸ê°€ `setTimeout` í•¨ìˆ˜ì´ì–´ì•¼ í•œë‹¤
- ì—ëŸ¬ëŠ” í˜¸ì¶œì ë°©í–¥ìœ¼ë¡œ ì „íŒŒëœë‹¤
  - ì½œìŠ¤íƒì˜ ì•„ë˜ ë°©í–¥ìœ¼ë¡œ ì „íŒŒë¨
  - í•˜ì§€ë§Œ `setTimeout` í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê²ƒì€ `setTimeout`í•¨ìˆ˜ê°€ ì•„ë‹ˆë‹¤ âŒ
    - ë”°ë¼ì„œ í•¨ìˆ˜ì˜ ì½œë°±í•¨ìˆ˜ê°€ ë°œìƒì‹œí‚¨ ì—ëŸ¬ëŠ” `catch` ë¸”ë¡ì—ì„œ ìºì¹˜í•  ìˆ˜ ì—†ë‹¤ âŒ
- ì´ëŸ¬í•œ ì½œë°±í—¬ì´ë‚˜ ì—ëŸ¬ì²˜ë¦¬ì˜ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ `ES6`ì—ëŠ” `Promise`ë¼ëŠ” í‘œì¤€ ë¹ŒíŠ¸ì¸ ê°ì²´ê°€ ë„ì…

```jsx
/* ì½œë°±íŒ¨í„´ì—ì„œ ì—ëŸ¬ ì²˜ë¦¬ì˜ í•œê³„ì  */
try {
  setTimeout(() => {
    throw new Error("Error");
  }, 1000);
} catch (error) {
  console.log("ìºì¹˜í•œ ì—ëŸ¬", error);
}
```

## í”„ë¡œë¯¸ìŠ¤ì˜ ìƒì„±

**Promise ê°ì²´ ìƒì„±ë°©ë²•**

- `Promise` ìƒì„±ì í•¨ìˆ˜ë¥¼ `new` ì—°ì‚°ìì™€ í˜¸ì¶œ
- ECMAScript ì‚¬ì–‘ì— ì •ì˜ëœ í‘œì¤€ ë¹ŒíŠ¸ì¸ ê°ì²´ì´ë‹¤
- `Promise` ìƒì„±ì í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•  ì½œë°±í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë‹¤
  - í•´ë‹¹ ì½œë°±í•¨ìˆ˜ëŠ” `resolve`ì™€ `reject`í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë‹¤

```jsx
/* í”„ë¡œë¯¸ìŠ¤ */

/* í”„ë¡œë¯¸ìŠ¤ ìƒì„± */
const promise = new Promise((resolve, reject) => {
    if (/* ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ê³µí–ˆì„ë•Œ ìˆ˜í–‰ë  resolve í•¨ìˆ˜ */) {
        resolve('ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ê³µ')
    } else {
        reject('ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨')
    }
})
```

**Promiseê°ì²´ë¥¼ í†µí•œ getData ë¦¬íŒ©í† ë§**

- ë¹„ë™ê¸° í•¨ìˆ˜ `promiseGetData`ëŠ” í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í”„ë¡œë¯¸ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜ëœë‹¤
- ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” `Promise` ìƒì„±ì í•¨ìˆ˜ê°€ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ì€ ì½œë°±í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìˆ˜í–‰
  - ë§Œì•½ í†µì‹ ì´ ì„±ê³µí•˜ë©´ ì²˜ë¦¬ê²°ê³¼ë¥¼ `resolve` í•¨ìˆ˜ì— ì¸ìˆ˜ë¡œ ì „ë‹¬í•˜ë©´ì„œ í˜¸ì¶œ
    - í†µì‹ ì´ ì‹¤íŒ¨í•˜ë©´ ì²˜ë¦¬ê²°ê³¼ë¥¼ `reject` í•¨ìˆ˜ì— ì¸ìˆ˜ë¡œ ì „ë‹¬í•˜ë©° í˜¸ì¶œ

```jsx
/* Promiseê°ì²´ë¥¼ í†µí•œ getData ë¦¬íŒ©í† ë§ */
const promiseGetData = (url) => {
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.send();
    xhr.onload = () => {
      xhr.status === 200
        ? resolve(JSON.parse(xhr.response))
        : reject(new Error(xhr.status));
    };
  });
};

const promiseObject = promiseGetData(END_POINT);
console.log(promiseObject);
```

<img src="./../../assets/docs/45_Promise/image2.png">

**í”„ë¡œë¯¸ìŠ¤ëŠ” í˜„ì¬ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì–´ë–»ê²Œ ì§„í–‰ë˜ê³  ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚˜ëŠ” ìƒíƒœë¥¼ ê°€ì§„ë‹¤**

| í”„ë¡œë¯¸ìŠ¤ ìƒíƒœ ì •ë³´ | ì˜ë¯¸                                  | ìƒíƒœ ë³€ê²½ ì¡°ê±´                   |
| ------------------ | ------------------------------------- | -------------------------------- |
| pending            | ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì•„ì§ ìˆ˜í–‰ë˜ì§€ ì•Šì€ ìƒíƒœ | í”„ë¡œë¨¸ìŠ¤ê°€ ìƒì„±ëœ ì§í›„ ê¸°ë³¸ ìƒíƒœ |
| fulfiled           | ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì„±ê³µí•œ ìƒíƒœ             | resolve ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ         |
| rejected           | ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì‹¤íŒ¨í•œ ìƒíƒœ             | reject ë¹„ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ          |

**í”„ë¡œë¯¸ìŠ¤ì˜ ìƒíƒœëŠ” resolve ë˜ëŠ” reject í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒìœ¼ë¡œ ê²°ì •ëœë‹¤**

- `setteld` ìƒíƒœ
  - `fulfiled` ë˜ëŠ” `rejected` ìƒíƒœ
  - `pending`ì´ ì•„ë‹Œ ìƒíƒœ
  - ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ìˆ˜í–‰ëœ ìƒíƒœ
- í”„ë¡œë¯¸ìŠ¤ëŠ” `pending` ìƒíƒœì—ì„œ `setteld` ìƒíƒœë¡œ ë³€í™”í•œë‹¤
  - í•˜ì§€ë§Œ ì¼ë‹¨ `settled` ìƒíƒœê°€ ë˜ë©´ ë”ëŠ” ë‹¤ë¥¸ ìƒíƒœë¡œ ë³€í™”í•  ìˆ˜ ì—†ë‹¤âŒ

<img src="./../../assets/docs/45_Promise/image3.png">

**í”„ë¡œë¯¸ìŠ¤ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœì™€ ë”ë¶ˆì–´ ë¹„ë™ê¸° ì²˜ë¦¬ê²°ê³¼ë„ ìƒíƒœë¡œ ê°€ì§„ë‹¤**

- ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ê³µ ì‹œ í”„ë¡œë¯¸ìŠ¤ëŠ” `pending` ìƒíƒœì—ì„œ `fulfilled` ìƒíƒœë¡œ ë³€í™”
  - ê·¸ë¦¬ê³  ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ì¸ 1ì„ ê°’ìœ¼ë¡œ ê°€ì§„ë‹¤

```jsx
/* í”„ë¡œë¯¸ìŠ¤ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœì™€ ë”ë¶ˆì–´ ë¹„ë™ê¸° ì²˜ë¦¬ê²°ê³¼ë„ ìƒíƒœë¡œ ê°€ì§„ë‹¤ */
const fullfilled = new Promise((res) => res(1));
console.log(fullfilled);
```

<img src="./../../assets/docs/45_Promise/image4.png">

**ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨ì‹œ í”„ë¡œë¯¸ìŠ¤ëŠ” pending ìƒíƒœì—ì„œrejected ìƒíƒœë¡œ ë³€í™”**

- ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ì¸ `Error` ê°ì²´ë¥¼ ê°’ìœ¼ë¡œ ê°€ì§„ë‹¤
- **í”„ë¡œë¯¸ìŠ¤ëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ìƒíƒœì™€ ì²˜ë¦¬ê²°ê³¼ë¥¼ ê´€ë¦¬í•˜ëŠ” ê°ì²´ì´ë‹¤**

```jsx
const rejected = new Promise((_, reject) => reject(new Error("rejected")));
console.log(rejected);
```

<img src="./../../assets/docs/45_Promise/image5.png">

## í”„ë¡œë¯¸ìŠ¤ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œ

**í”„ë¡œë¯¸ìŠ¤ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœê°€ ë³€í™”ë˜ë©´ ì´ì— ë”°ë¥¸ í›„ì†ì²˜ë¦¬ë¥¼ í•´ì•¼í•œë‹¤**

- í”„ë¡œë¯¸ìŠ¤ê°€ `fulfiled` ìƒíƒœê°€ ë˜ë©´ í”„ë¡œë¯¸ìŠ¤ì˜ ì²˜ë¦¬ê²°ê³¼ë¥¼ ê°€ì§€ê³  ë¬´ì–¸ê°€ë¥¼ í•´ì•¼í•˜ê³ 
- í”„ë¡œë¯¸ìŠ¤ê°€ `reject`ê°€ ë˜ë©´ ê·¸ì— ë”°ë¥¸ ì²˜ë¦¬ê²°ê³¼ë¥¼ ê°€ì§€ê³  ì—ëŸ¬í•¸ë“¤ë§ì„ í•´ì•¼í•œë‹¤
  - ì´ë¥¼ ìœ„í•´ í”„ë¡œë¯¸ìŠ¤ëŠ” í›„ì† ë©”ì„œë“œ `then`,`catch`,`finally`ë¥¼ ì œê³µ
- í”„ë¡œë¯¸ìŠ¤ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ìƒíƒœ ë³€í™”ì‹œ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œì— ì¸ìˆ˜ë¡œ ì „ë‹¬í•œ ì½œë°±í•¨ìˆ˜ê°€ ì„ íƒì ìœ¼ë¡œ í˜¸ì¶œ
  - ì´ë•Œ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œì˜ ì½œë°±í•¨ìˆ˜ì— í”„ë¡œë¯¸ìŠ¤ì˜ ì²˜ë¦¬ê²°ê³¼ê°€ ì¸ìˆ˜ë¡œ ì „ë‹¬
- ëª¨ë“  í›„ì†ì²˜ë¦¬ ë©”ì„œë“œëŠ” í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•˜ë©° ë¹„ë™ê¸°ë¡œ ë™ì‘í•œë‹¤

### Promise.prototype.then

**then ë©”ì„œë“œê°€ ì „ë‹¬ë°›ëŠ” ì¸ìˆ˜**

- ì²«ë²ˆì§¸ ì½œë°±í•¨ìˆ˜ (resolve)
  - í”„ë¡œë¯¸ìŠ¤ê°€ `fulfilled` ìƒíƒœê°€ ë˜ë©´ í˜¸ì¶œ
  - ì´ë•Œ ì½œë°±í•¨ìˆ˜ëŠ” í”„ë¡œë¯¸ìŠ¤ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë‹¤
- ë‘ë²ˆì§¸ ì½œë°± í•¨ìˆ˜ (reject)
  - í”„ë¡œë¯¸ìŠ¤ê°€ `reject` ìƒíƒœê°€ ë˜ë©´ í˜¸ì¶œ ë¨
  - ì´ë•Œ ì½œë°±í•¨ìˆ˜ëŠ” í”„ë¡œë¯¸ìŠ¤ì˜ ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë‹¤

```tsx
/* then ë©”ì„œë“œê°€ ì „ë‹¬ë°›ëŠ” ì¸ìˆ˜ */
new Promise((resolve) => resolve("fullfilled")).then((v) => console.log(v)); // 'fullfilled'
new Promise((_, reject) => reject("Error")).then(
  "",
  (e) => console.log(e) // 'Error'
);
```

### Promise.prototype.catch

**catch ë©”ì„œë“œ**

- í•œê°œì˜ ì½œë°±í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë°
  - `catch` ë©”ì„œë“œì˜ í•œê°œì˜ ì½œë°±í•¨ìˆ˜ëŠ” `rejected` ìƒíƒœì¸ ê²½ìš°ì—ë§Œ í˜¸ì¶œëœë‹¤

```jsx
/* Promise.prototype.catch */
new Promise((_, reject) => reject(new Error("ë¹„ë™ê¸° í†µì‹  ì‹¤íŒ¨!"))).catch((e) =>
  console.log(e)
); /* Promise.prototype.catch */
new Promise((_, reject) => reject(new Error("ë¹„ë™ê¸° í†µì‹  ì‹¤íŒ¨!"))).catch((e) =>
  console.log(e)
);
```

<br />

<img src="./../../assets/docs/45_Promise/image6.png">

<br />

### Promise.prototype.finally

**finally ë©”ì„œë“œ**

- í”„ë¡œë¯¸ìŠ¤ì˜ ì„±ê³µ,ì‹¤íŒ¨ì— ìƒê´€ì—†ì´ ë¬´ì¡°ê±´ ì ì¸ í•œë²ˆì˜ í˜¸ì¶œì„ ë³´ì¥
- í”„ë¡œë¯¸ìŠ¤ì˜ ìƒíƒœì— ìƒê´€ì—†ì´ ê³µí†µì ìœ¼ë¡œ ìˆ˜í–‰í•´ì•¼í•  ì½”ë“œë¥¼ ë„£ëŠ”ë‹¤
- í•´ë‹¹ ë©”ì„œë“œë„ ì–¸ì œë‚˜ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤

```jsx
/* Promise.prototype.finally */

const finallyPromise = new Promise(() => {}).finally(() =>
  console.log("ë¬´ì ê¶Œ ì‹¤í–‰")
);

console.log(finallyPromise);
```

<br />

<img src="./../../assets/docs/45_Promise/image7.png">

<br />

> ğŸ’¡ **í”„ë¡œë¯¸ìŠ¤ë¡œ êµ¬í˜„í•œ ë¹„ë™ê¸° í•¨ìˆ˜ getDataë¥¼ ì‚¬ìš©í•´ í›„ì†ì²˜ë¦¬ êµ¬í˜„**

```jsx
/* í”„ë¡œë¯¸ìŠ¤ë¡œ êµ¬í˜„í•œ ë¹„ë™ê¸° í•¨ìˆ˜ getDataë¥¼ ì‚¬ìš©í•´ í›„ì†ì²˜ë¦¬ êµ¬í˜„ */
promiseGetData(END_POINT)
  .then((res) => console.log(res))
  .catch((err) => console.error(err))
  .finally(() => {
    console.log("ë¬´ì¡°ê±´ ì‹¤í–‰"); // 'ë¬´ì¡°ê±´ ì‹¤í–‰'
  });
```

<br />

<img src="./../../assets/docs/45_Promise/image8.png">

<br />

## í”„ë¡œë¯¸ìŠ¤ì˜ ì—ëŸ¬ ì²˜ë¦¬

**í”„ë¡œë¯¸ìŠ¤ëŠ” ì—ëŸ¬ë¥¼ ë¬¸ì œì—†ì´ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œëœë‹¤**

- ì²˜ë¦¬ë°©ë²•ì€ ë‘ê°€ì§€ ì¡´ì¬
  - `then` ë©”ì„œë“œì˜ ë‘ë²ˆì§¸ ì¸ìˆ˜ ì½œë°±í•¨ìˆ˜ `reject`ë¥¼ í˜¸ì¶œí•´ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•
  - `catch` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œ ì—ëŸ¬í•¸ë“¤ë§
- `catch`ë©”ì„œë“œë¥¼ í†µí•´ ëª¨ë“  `then`ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œ ì´í›„ì— í˜¸ì¶œí•˜ë©´ ë¹„ë™ê¸° ì²˜ë¦¬ì—ì„œë°œìƒí•œ ì—ëŸ¬ ë¿ë§Œì•„ë‹ˆë¼ `then`ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ê¹Œì§€ ëª¨ë‘ ìºì¹˜í•  ìˆ˜ ìˆê²Œëœë‹¤
- `then`ë©”ì„œë“œì— ë‘ë²ˆì§¸ ì½œë°± í•¨ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•(1)ë³´ë‹¤ `catch`ë©”ì„œë“œë¥¼ ì‚¬ìš©(2)í•˜ëŠ” ê²ƒì´ ê°€ë…ì„±ì´ ì¢‹ê³  ëª…í™•í•˜ë‹¤
- ë”°ë¼ì„œ ì—ëŸ¬ì²˜ë¦¬ì— ëŒ€í•´ì„  `then`ë©”ì„œë“œ ë‘ë²ˆì§¸ ì½œë°±í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒë³´ë‹¤ `catch`ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤

## í”„ë¡œë¯¸ìŠ¤ ì²´ì´ë‹

**ì½œë°±í—¬ì´ ë°œìƒí•œ ì˜ˆì œë¥¼ í”„ë¡œë¯¸ìŠ¤ ì²´ì´ë‹ì„ í†µí•´ ë‹¤ì‹œ êµ¬í˜„**

- ì•„ë˜ ì½”ë“œì—ì„  `then` â¡ï¸ `then` â¡ï¸ `catch` ìˆœì„œë¡œ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œ
- `then`,`catch`,`finally`ë©”ì„œë“œëŠ” ì–¸ì œë‚˜ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ ì—°ì†ì ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥
- ì´ë¥¼ í”„ë¡œë¨¸ìŠ¤ ì²´ì´ë‹ì´ë¼ê³  í•œë‹¤

```jsx
/* ì½œë°±í—¬ì´ ë°œìƒí•œ ì˜ˆì œë¥¼ í”„ë¡œë¯¸ìŠ¤ ì²´ì´ë‹ì„ í†µí•´ ë‹¤ì‹œ êµ¬í˜„ */
const BASE_URL = "https://jsonplaceholder.typicode.com";
promiseGetData(`${BASE_URL}/posts/1`)
  .then(({userId}) => promiseGetData(`${BASE_URL}/users/${userId}`))

  /* {id: 1, name: 'Leanne Graham', username: 'Bret', email: 'Sincere@april.biz', address: {â€¦},Â â€¦} */
  .then((userInfo) => console.log(userInfo))
  .catch((erorr) => console.error(erorr));
```

**í”„ë¡œë¯¸ìŠ¤ëŠ” í”„ë¡œë¯¸ìŠ¤ ì²´ì´ë‹ì„ í†µí•´ ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì „ë‹¬ë°›ì•„ í›„ì†ì²˜ë¦¬ë¥¼ í•œë‹¤**

- ë”°ë¼ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì½œë°± í˜í„´ì—ì„œ ë°œìƒí•˜ë˜ ì½œë°± ì§€ì˜¥ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤ âŒ
- ë‹¤ë§Œ, í”„ë¡œë¯¸ìŠ¤ë„ ì½œë°± íŒ¨í„´ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì½œë°±í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ê²ƒì€ ì•„ë‹ˆë‹¤
  - ì½œë°±íŒ¨í„´ì€ ê°€ë…ì„±ì´ ë‚˜ì¨
  - í•´ë‹¹ ë¬¸ì œëŠ” ES8ì—ì„œ ë„ì…ëœ `async/await`ë¥¼ í†µí•´ í•´ê²° ê°€ëŠ¥
  - `async/awiat`ë¥¼ í†µí•´ í”„ë¡œë¯¸ìŠ¤ì˜ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œ(`then,catch,finally`)ì—†ì´ ë§ˆì¹˜ ë™ê¸°ì²˜ë¦¬ì™€ ê°™ì´ ì²˜ë¦¬ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ë„ë¡ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤

**async/awaitë¥¼ í†µí•œ í›„ì†ì²˜ë¦¬**

```jsx
(async () => {
  const {userId} = await promiseGetData(`${BASE_URL}/posts/1`);
  const userInfo = await promiseGetData(`${BASE_URL}/users/${userId}`);
  console.log(userInfo);
})();
```

## í”„ë¡œë¯¸ìŠ¤ì˜ ì •ì  ë©”ì„œë“œ

**PromiseëŠ” ì£¼ë¡œ ìƒì„±ì í•¨ìˆ˜ë¡œì„œ ì‚¬ìš©ë˜ì§€ë§Œ í•¨ìˆ˜ë„ ê°ì²´ì´ë¯€ë¡œ ë©”ì„œë“œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤**

### Promise.resolve/Promise.reject

**ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê°’ì„ ë˜í•‘í•´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ì‚¬ìš©**

```jsx
/* Promise.resolve / Promise.reject */
const resolvedPromise = Promise.resolve([1, 2, 3]);
resolvedPromise.then((res) => console.log(res)); // [1,2,3]

const rejectedPromise = Promise.reject(new Error("ì—ëŸ¬ ê°ì²´"));
rejectedPromise.catch((error) => console.log(error)); // Error : ì—ëŸ¬ê°ì²´
```

### Promise.all

**Promise.all ë©”ì„œë“œ**

- ì—¬ëŸ¬ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ëª¨ë‘ ë³‘ë ¬ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©
- ì•„ë˜ì½”ë“œì—ì„  ì„¸ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬
  - ì•ì„  ë¹„ë™ê¸° ì²˜ë¦¬ ì™„ë£Œ ì‹œ ë‹¤ìŒ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìˆ˜í–‰
  - ë”°ë¼ì„œ ì•„ë˜ ì½”ë“œëŠ” ì²«ë²ˆì§¸ ë¹„ë™ê¸°ì²˜ë¦¬ì— 3ì´ˆ, ë‘ë²ˆì§¸ ë¹„ë™ê¸°ì²˜ë¦¬ì— 2ì´ˆ, ë§ˆì§€ë§‰ ë¹„ë™ê¸° ì²˜ë¦¬ì— 1ì´ˆê°€ ì†Œìš”ë˜ì–´ ì´ 6ì´ˆê°€ ì†Œìš”ëœë‹¤
- ì„¸ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ëŠ” ì„œë¡œ ì˜ì¡´í•˜ì§€ ì•Šê³  ê°œë³„ì ìœ¼ë¡œ ìˆ˜í–‰ë˜ê³  ìˆìŒ
  - ì•ì„  ë¹„ë™ê¸° ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë‹¤ìŒ ë¹„ë™ê¸° ì²˜ë¦¬ê°€ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ âŒ
  - ë”°ë¼ì„œ ì„¸ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤ âŒ

```jsx
const requestData = () =>
  new Promise((resolve) => setTimeout(() => resolve(1), 3000));
const requestData2 = () =>
  new Promise((resolve) => setTimeout(() => resolve(2), 2000));
const requestData3 = () =>
  new Promise((resolve) => setTimeout(() => resolve(3), 1000));

const result = [];
requestData()
  .then((data) => {
    result.push(data);
    return requestData2();
  })
  .then((data) => {
    result.push(data);
    return requestData3();
  })
  .then((data) => {
    result.push(data);
    console.log(result);
  });
```

**Promise.allì„ ì‚¬ìš©í•œ ë³‘ë ¬ì²˜ë¦¬**

```jsx
/* Promise.allì„ ì‚¬ìš©í•œ ë³‘ë ¬ì²˜ë¦¬ */
const all = Promise.all([requestData(), requestData2(), requestData3()]).then(
  console.log
);

// [1,2,3] -> ì•½ 3ì´ˆ ì†Œìš”ë¨
console.log(all);
```

**Promise.all ë©”ì„œë“œ í•„ìš”ì¸ìˆ˜ëŠ”?**

- í”„ë¡œë¯¸ìŠ¤ë¥¼ ìš”ì†Œë¡œ ê°€ì§€ëŠ” ë°°ì—´ ë“±ì˜ ì´í„°ëŸ¬ë¸”
  - ì „ë‹¬ë°›ì€ ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ê°€ ëª¨ë‘ `fullfuiled` ìƒíƒœê°€ ë˜ë©´ ëª¨ë“  ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë°°ì—´ì— ì €ì¥í•´ ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜
- ìœ„ ì½”ë“œì—ì„œ `Promise.all` ë©”ì„œë“œì˜ ê° ìš”ì†ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•œë‹¤
  - ì²«ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ëŠ” 3ì´ˆ í›„ì— 1ì„ `resolve`
  - ë‘ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ëŠ” 2ì´ˆí›„ 2ë¥¼ `resole`
  - ì„¸ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ëŠ” 1ì´ˆí›„ 3ì„ `resolve`
- ì´ë•Œ ì²«ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ê°€ ê°€ì¥ ë‚˜ì¤‘ì— fulfilled ìƒíƒœê°€ ë˜ì–´ë„ `Promise.all` ë©”ì„œë“œëŠ” ì²«ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ê°€ `resolve`í•œ ì²˜ë¦¬ ê²°ê³¼ë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ë°°ì—´ì— ì €ì¥í•œë‹¤
  - ì¦‰, `Promise.all`ì„ í†µí•´ ì²˜ë¦¬ ìˆœì„œë¥¼ ë³´ì¥ë°›ì„ ìˆ˜ ìˆë‹¤

**Promise.all ë©”ì„œë“œëŠ” ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ì€ ë°°ì—´ì˜ í”„ë¡œë¯¸ìŠ¤ê°€ í•˜ë‚˜ë¼ë„ rejected ìƒíƒœê°€ ë  ì‹œ ë‚˜ë¨¸ì§€ í”„ë¡œë¯¸ìŠ¤ê°€ fulfilled ìƒíƒœê°€ ë˜ëŠ” ê²ƒì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì¦‰ì‹œ ì¢…ë£Œí•œë‹¤**

```jsx
/* í•˜ë‚˜ë¼ë„ rejected ìƒíƒœê°€ ë  ì‹œ ë‚˜ë¨¸ì§€ í”„ë¡œë¯¸ìŠ¤ê°€ fulfilled ìƒíƒœê°€ ë˜ëŠ” ê²ƒì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì¦‰ì‹œ ì¢…ë£Œ */

Promise.all([
  new Promise((_, reject) =>
    setTimeout(() => reject(new Error("ì²«ë²ˆì§¸ ì—ëŸ¬")), 3000)
  ),
  new Promise((_, reject) =>
    setTimeout(() => reject(new Error("ë‘ë²ˆì§¸ ì—ëŸ¬")), 2000)
  ),
  /* 3ë²ˆì§¸ í”„ë¡œë¯¸ìŠ¤ê°ì²´ê°€ ê°€ì¥ ë¨¼ì € ì—ëŸ¬ê°€ ë°œìƒ(1ì´ˆ)í•˜ë¯€ë¡œ catchë©”ì„œë“œë¡œ ì „ë‹¬ í›„ ì¢…ë£Œ */
  new Promise((_, reject) =>
    setTimeout(() => reject(new Error("ì„¸ë²ˆì§¸ ì—ëŸ¬")), 1000)
  ),
]).catch((erorr) => console.error(erorr));
```

**ê¹ƒí—ˆë¸Œ ì•„ì´ë””ë¡œ ê¹ƒí—ˆë¸Œ ì‚¬ìš©ì ì´ë¦„ì„ ì·¨ë“í•˜ëŠ” 3ê°œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ëª¨ë‘ ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì œ**

- `prmiseGetData`í•¨ìˆ˜ê°€ ë°˜í™˜í•œ 3ê°œì˜ í”„ë¡œë¯¸ìŠ¤ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì„ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ê³  í”„ë¡œë¯¸ìŠ¤ë“¤ì´ ëª¨ë‘ `fullfield`ìƒíƒœê°€ ë˜ë©´ ì²˜ë¦¬ê²°ê³¼ë¥¼ ë°°ì—´ì— ì €ì¥í•´ ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜
- ì´ë•Œ `Prmise.all` ë©”ì„œë“œê°€ ë°˜í™˜í•œ í”„ë¡œë¯¸ìŠ¤ëŠ” ì„¸ê°œì˜ ì‚¬ìš©ì ê°ì²´ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì„ ë‹´ê³  ìˆë‹¤
  - í•´ë‹¹ ë°°ì—´ì€ ì²«ë²ˆì§¸ `then`ë©”ì„œë“œì— ì¸ìˆ˜ë¡œ ì „ë‹¬ëœë‹¤

```tsx
const promiseGetData = (url) => {
  return new Promise((resolve, reject) => {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.send();
    xhr.onload = () => {
      xhr.status === 200
        ? resolve(JSON.parse(xhr.response))
        : reject(new Error(xhr.status));
    };
  });
};

const githubIds = ["suwan98", "simseonbeom", "yamoo9"];

const response = Promise.all(
  githubIds.map((id) => promiseGetData(`https://api.github.com/users/${id}`))
).then((users) => users.map((user) => user));

console.log(response);
```

<br />

<img src="./../../assets/docs/45_Promise/image9.png">

<br />

### Promise.race

**Promise.race**

- `Prmise.all`ê³¼ ë™ì¼í•˜ê²Œ í”„ë¡œë¯¸ìŠ¤ë¥¼ ìš”ì†Œë¡œ ê°€ì§€ëŠ” ë°°ì—´ë“±ì˜ ì´í„°ëŸ¬ë¸”ì„ ì¸ìˆ˜ë¡œ ì „ë‹¬ë°›ëŠ”ë‹¤
- ì°¨ì´ì ì€?
  - `Promise.all`ê³¼ ë‹¬ë¦¬ ëª¨ë“  í”„ë¡œë¯¸ìŠ¤ê°€ `fufilled`ìƒíƒœê°€ ë˜ëŠ”ê²ƒì„ ê¸°ë‹¤ë¦¬ì§€ì•Šê³  ê°€ì¥ ë¨¼ì € `fulfilled` ìƒíƒœê°€ ëœ í”„ë¡œë¯¸ìŠ¤ì˜ ì²˜ë¦¬ ê²°ê³¼ë¥¼ `resolve`í•˜ëŠ” í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤
- rejectì¸ ê²½ìš°ëŠ” ë™ì¼
  - ì „ë‹¬ëœ í”„ë¡œë¯¸ìŠ¤ê°€ í•˜ë‚˜ë¼ë„ rejected ìƒíƒœê°€ ë˜ë©´ ì—ëŸ¬ë¥¼ rejectí•˜ëŠ” ìƒˆë¡œìš´ í”„ë¡œë¯¸ìŠ¤ë¥¼ ì¦‰ì‹œ ë°˜í™˜í•˜ê²Œ ëœë‹¤

```jsx
Promise.race([
  new Promise((resolve) => setTimeout(() => resolve(1), 3000)),
  new Promise((resolve) => setTimeout(() => resolve(2), 2000)),
  new Promise((resolve) => setTimeout(() => resolve(3), 1000)),
]).then(console.log); // 3;
```

### Promise.allSettled

**Promise.allSettled**

- ì „ë‹¬ë°›ì€ í”„ë¡œë¯¸ìŠ¤ê°€ ëª¨ë‘ `settled` ìƒíƒœ(ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨)ê°€ ë˜ë©´ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë°°ì—´ë¡œ ë°˜í™˜

```jsx
Promise.allSettled([
  new Promise((resolve) => setTimeout(() => resolve(1), 2000)),
  new Promise((_, reject) => setTimeout(() => reject(new Error("ì—˜ì–´")), 1000)),
]).then(console.log);
```

## ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ í

**ì•„ë˜ì½”ë“œì—ì„  ì–´ë–¤ ìˆœì„œë¡œ ë¡œê·¸ê°€ ì¶œë ¥ë ê¹Œ?**

- í”„ë¡œë¯¸ìŠ¤ì˜ í›„ì† ì²˜ë¦¬ ë©”ì„œë“œ ë˜í•œ ë¹„ë™ê¸°ë¡œ ë™ì‘í•˜ë¯€ë¡œ 1â¡ï¸ 2â¡ï¸ 3ì˜ ìˆœìœ¼ë¡œ ë™ì‘í• ê²ƒê°™ë‹¤
  - ê·¸ëŸ¬ë‚˜ âŒ
  - 2 â¡ï¸ 3 â¡ï¸ 1 ìˆœìœ¼ë¡œ ì¶œë ¥
- ê·¸ ì´ìœ ëŠ” ë­˜ê¹Œ?
  - í”„ë¡œë¯¸ìŠ¤ì˜ í›„ì†ì²˜ë¦¬ ë©”ì„œë“œì˜ ì½œë°±í•¨ìˆ˜ëŠ” íƒœìŠ¤í¬íê°€ ì•„ë‹Œ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íì— ì €ì¥ë˜ë¯€ë¡œ
- ë§ˆì´í¬ë¡œ íƒœìŠ¤í¬íëŠ” íƒœìŠ¤í¬ íì™€ì˜ ë³„ë„ì˜ í
  - í•´ë‹¹ íì—ëŠ” í”„ë¡œë¯¸ìŠ¤ì˜ í›„ì†ì²˜ë¦¬ ë©”ì„œë“œì˜ ì½œë°±í•¨ìˆ˜ê°€ ì¼ì‹œ ì €ì¥
- ìš°ì„ ìˆœìœ„
  - ë§ˆì´í¬ë¡œ íƒœìŠ¤í¬ í > íƒœìŠ¤í¬í
  - ì´ë²¤íŠ¸ë£¨í”„ëŠ” ì½œìŠ¤íƒì´ ë¹„ë©´ ë¨¼ì € ë§ˆì´í¬ë¡œ íƒœìŠ¤í¬ íì—ì„œ ëŒ€ê¸° ì¤‘ì¸ í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™€ ë¨¼ì € ì‹¤í–‰
  - ì´í›„ ë§ˆì´í¬ë¡œíƒœìŠ¤í¬ íê°€ ë¹„ë©´ íƒœìŠ¤í¬ íì—ì„œ ëŒ€ê¸°í•˜ê³  ìˆëŠ” í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™€ ì‹¤í–‰

```jsx
setTimeout(() => console.log(1), 0);
Promise.resolve()
  .then(() => console.log(2))
  .then(() => console.log(3));
```

## fetch

**fetchë€?**

- `fetch`í•¨ìˆ˜ëŠ” `XMLHttpRequest` ê°ì²´ì™€ ë§ˆì°¬ê°€ì§€ë¡œ `HTTP` ìš”ì²­ ì „ì†¡ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ Web aPI

**í•„ìš”ë¡œ í•˜ëŠ” ì¸ìˆ˜**

- URL
- HTTP ìš”ì²­ ë©”ì„œë“œ
- HTTP ìš”ì²­ í—¤ë”
- í˜ì´ë¡œë“œ

```tsx
const promise = fetch(url, [,..options]
```

**fetch í•¨ìˆ˜ëŠ” HTTP ìš”ì²­ì„ ë‚˜íƒ€ë‚´ëŠ” Response ê°ì²´ë¥¼ ë˜í•‘í•œ Promise ê°ì²´ë¥¼ ë°˜í™˜**

```tsx
fetch(BASE_URL).then((response) => console.log(response));
```

<br />

<img src="./../../assets/docs/45_Promise/image10.png">

<br />

**fetch í•¨ìˆ˜ ì‚¬ìš© ì‹œ ì—ëŸ¬ í•¸ë“¤ë§ì— ì£¼ì˜í•´ì•¼í•¨**

- `fetch`í•¨ìˆ˜ê°€ ë°˜í™˜í•˜ëŠ” í”„ë¡œë¯¸ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `404 Not Found`ë‚˜ `500 Internal Serever Error`ì™€ ê°™ì€ HTTP ì—ëŸ¬ë°œìƒ ì‹œ ì—ëŸ¬ë¥¼ `reject`í•˜ì§€ ì•ŠëŠ”ë‹¤
- ì˜¤í”„ë¼ì¸ ë“±ì˜ ë„¤íŠ¸ì›Œí¬ ì¥ì•  ë° CORS ì—ëŸ¬ì— ì˜í•´ ìš”ì²­ì´ ì™„ë£Œë˜ì§€ ëª»í•œ ê²½ìš°ì—ë§Œ í”„ë¡œë¯¸ìŠ¤ë¥¼ `reject`í•œë‹¤
- ë”°ë¼ì„œ `fetch`í•¨ìˆ˜ê°€ ë°˜í™˜í•œ í”„ë¡œë¯¸ìŠ¤ê°€ `resolve`í•œ ë¶ˆë¦¬ì–¸ íƒ€ì…ì˜ ok ìƒíƒœì— ë”°ë¼ ëª…ì‹œì ìœ¼ë¡œ ì—ëŸ¬ë¥¼ í•¸ë“¤ë§ í•´ì•¼í•œë‹¤

```jsx
/* fetch í•¨ìˆ˜ì—ì„œì˜ ì—ëŸ¬ í•¸ë“¤ë§ */

const wrongURL = "https://jsonplaceholder.typicode.com/XXX/1";
fetch(wrongURL)
  .then((response) => {
    if (!response.ok) throw new Error(response.statusText);
    return response.json();
  })
  .then((todo) => console.log(todo))
  .catch((err) => console.error(err));
```

## **fetchë¥¼ í†µí•œ HTTP ìš”ì²­ ë©”ì„œë“œ ì§€ì›**

**fetchRequest ê°ì²´ êµ¬ì„±**

```jsx
const fetchRequest = {
  get(url) {
    return fetch(url);
  },
  post(url, payload) {
    return fetch(url, {
      method: "POST",
      headers: {"content-Type": "applicaiton/json"},
      body: JSON.stringify(payload),
    });
  },
  patch(url, payload) {
    return fetch(url, {
      method: "PATCH",
      headers: {"content-Type": "applicaiton/json"},
      body: JSON.stringify(payload),
    });
  },
  delete(url) {
    return fetch(url, {method: "DELETE"});
  },
};
```

### GET ìš”ì²­

```jsx
const responseTodo = fetchRequest
  .get(END_POINT)
  .then((response) => {
    if (!response.ok) throw new Error("í†µì‹  ì‹¤íŒ¨");
    return response.json();
  })
  .then((res) => {
    console.log(res);
  });
```

<br />

<img src="./../../assets/docs/45_Promise/image11.png">

<br />
